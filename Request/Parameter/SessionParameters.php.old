<?php
/**
 * Created by PhpStorm.
 * User: ari
 * Date: 11/1/14
 * Time: 5:52 PM
 */
namespace CPath\Request\Parameter;

use BC\Games\Holdem\Exceptions\InvalidReplayException;
use CPath\Request\IRequest;

class SessionParameters
{
	private static $requests = array();
	private $mParams = array();
	private $mExceptions = array();

	function __construct(IRequest $Request) {
		$id = spl_object_hash($Request);
		if (!isset(self::$requests[$id]))
			self::$requests[$id] = array(array(), array());

		$this->mParams = & self::$requests[$id][0];
		$this->mExceptions = & self::$requests[$id][1];
	}

	function get($paramName) {
		if (!$this->has($paramName))
			throw new InvalidReplayException("Param not found: " . $paramName);

		return $this->mParams[$paramName];
	}

	function has($paramName) {
		return isset($this->mParams[$paramName]);
	}

	function add(IRequestParameter $Parameter) {
		$name = $Parameter->getName();
		if(!isset($this->mParams[$name]))
			$this->mParams[$name] = $Parameter;
	}

	function addException(\Exception $ex) {
		$this->mExceptions[] = $ex;
	}

	function getExceptions() {
		return $this->mExceptions;
	}

	function reset() {
		$this->mParams = array();
		$this->mExceptions = array();
	}
}